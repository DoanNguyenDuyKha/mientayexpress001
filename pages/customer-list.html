<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý khách hàng - Mien Tay Express</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="../css/customer-list.css">
    <link rel="stylesheet" href="../css/package_manager.css">
</head>
<body>
<script>
function updateHeaderBlur() {
    var header = document.querySelector('.header');
    var anyModalOpen = false;
    document.querySelectorAll('.modal').forEach(function(modal){
        var style = window.getComputedStyle(modal);
        if(style.display === 'flex' || style.display === 'block') anyModalOpen = true;
    });
    if(document.querySelector('.announcement-overlay.visible')) anyModalOpen = true;
    if (header) {
        if (anyModalOpen) {
            header.classList.add('blurred');
            if (!header.querySelector('.header-dark-overlay')) {
                var overlay = document.createElement('div');
                overlay.className = 'header-dark-overlay';
                header.appendChild(overlay);
            }
        } else {
            header.classList.remove('blurred');
            var overlay = header.querySelector('.header-dark-overlay');
            if (overlay) overlay.remove();
        }
    }
}
</script>
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <img src="../images/logo-removebg.png" alt="Mien Tay Express Logo" class="logo">
        </div>
        <nav class="menu-items" aria-label="Main Navigation">
             <ul>
                <li><a href="../index.html"><i class="fa-solid fa-house icon"></i><span class="menu-text">TRANG CHỦ</span></a></li>
                 <li><a href="create-package.html"><i class="fa-solid fa-plus icon"></i><span class="menu-text">TẠO ĐƠN HÀNG</span></a></li>
                 <li>
                     <a href="#" class="submenu-parent"> <i class="fa-solid fa-chart-pie icon"></i><span class="menu-text">QUẢN LÝ</span><i class="fa-solid fa-chevron-down submenu-arrow"></i> </a>
                     <div class="submenu">
                         <ul>
                             <li><a href="package_manager.html"><i class="fa-solid fa-box-archive icon"></i><span class="menu-text">Quản lý đơn hàng</span></a></li>
                             <li><a href="straking-bill-of-lading-status.html"><i class="fa-solid fa-list-check icon"></i><span class="menu-text">Quản lý trạng thái</span></a></li>
                             <li><a href="pickup-package.html"><i class="fa-solid fa-truck-fast icon"></i><span class="menu-text">Quản lý vận chuyển</span></a></li>
                             <li><a href="#"><i class="fa-solid fa-building-user icon"></i><span class="menu-text">Quản lý chi nhánh</span></a></li>
                             <li><a href="payment-management.html"><i class="fa-solid fa-dollar-sign icon"></i><span class="menu-text">Quản lý thanh toán</span></a></li>
                         </ul>
                     </div>
                 </li>
                 <li><a href="statistics_management.html"><i class="fa-solid fa-chart-line icon"></i><span class="menu-text">THỐNG KÊ</span></a></li>
                 <li><a href="service-management.html"><i class="fa-solid fa-screwdriver-wrench icon"></i><span class="menu-text">QL DỊCH VỤ</span></a></li>
                 <li><a href="customer-list.html" class="submenu-parent active" ><i class="fa-solid fa-users icon"></i><span class="menu-text">QL KHÁCH HÀNG</span></a></li>
                  <li>
                      <a href="#" class="submenu-parent"><i class="fa-solid fa-user-tie icon"></i><span class="menu-text">QUẢN LÝ NHÂN SỰ</span><i class="fa-solid fa-chevron-down submenu-arrow"></i></a>
                      <div class="submenu">
                          <ul>
                            <li><a href="#"><span class="menu-text">Danh sách NV</span></a></li>
                            <li><a href="#"><span class="menu-text">Phân quyền</span></a></li>
                          </ul>
                      </div>
                  </li>
                 <li><a href="#"><i class="fa-solid fa-circle-info icon"></i><span class="menu-text">THÔNG TIN CÔNG TY</span></a></li>
                  <li>
                      <a href="#" class="submenu-parent"><i class="fa-solid fa-scroll icon"></i><span class="menu-text">QL CHÍNH SÁCH</span><i class="fa-solid fa-chevron-down submenu-arrow"></i></a>
                       <div class="submenu">
                          <ul>
                            <li><a href="#"><span class="menu-text">Chính sách A</span></a></li>
                            <li><a href="#"><span class="menu-text">Chính sách B</span></a></li>
                          </ul>
                      </div>
                  </li>
                 <li><a href="#"><i class="fa-solid fa-circle-question icon"></i><span class="menu-text">HƯỚNG DẪN SỬ DỤNG</span></a></li>
                 <li>
                     <a href="#" class="submenu-parent"><i class="fa-solid fa-gear icon"></i><span class="menu-text">CÀI ĐẶT CHUNG</span><i class="fa-solid fa-chevron-down submenu-arrow"></i></a>
                      <div class="submenu">
                          <ul>
                            <li><a href="#"><span class="menu-text">Cài đặt A</span></a></li>
                            <li><a href="#"><span class="menu-text">Cài đặt B</span></a></li>
                          </ul>
                      </div>
                  </li>
             </ul>
         </nav>
    </aside>

    <div class="sidebar-overlay" id="sidebar-overlay"></div>

    <main class="main-content">
        <header class="header">
            <button class="mobile-sidebar-toggle" id="mobile-sidebar-toggle" aria-label="Toggle Navigation Menu" aria-controls="sidebar" aria-expanded="false"> <i class="fa-solid fa-bars"></i> </button>
            <div class="header-left">
                <div class="search-container">
                    <i class="fa-solid fa-magnifying-glass search-icon"></i>
                    <input type="text" class="header-search-input" placeholder="Mã vận đơn / Tracking ID...">
                </div>
            </div>
            <div class="header-actions" style="display: flex; align-items: center; gap: 1.2rem; margin-left: auto;">
                <div class="notification-wrapper">
                    <button class="notification-button" id="notification-button" title="Thông báo">
                        <i class="fa-regular fa-bell"></i>
                        <span class="notification-badge">5</span>
                    </button>
                    <div class="notification-dropdown" id="notification-dropdown">
                        <div class="dropdown-header">Thông báo</div>
                        <ul class="notification-list" id="notification-list">
                            <li class="notification-item" data-title="Thông báo: DỜI CUT OFF CANADA 24/08/2024" data-body="Do lượng hàng T7 (24/08/2024) không đủ tải, chuyến tuyến MTE-CAD sẽ kết nối hàng vào chuyến bay sớm nhất (Cs sẽ update giờ cut off mới)||MTE xin lỗi Quý khách vì sự chậm trễ gây ra bất tiện cho khách hàng.||Rất mong nhận sự thông cảm của Quý khách hàng.||Cs tuyến Canada." data-timestamp="2024-07-25 13:53:27">
                                <div class="item-icon"><i class="fa-solid fa-calendar-xmark"></i></div>
                                <div class="item-content">
                                    <div class="item-title">Dời Cut off Canada 24/08/2024</div>
                                    <div class="item-time">25 Jul 2024</div>
                                </div>
                            </li>
                            <li class="notification-item" data-title="Thông báo: Cập nhật hệ thống" data-body="Hệ thống sẽ được bảo trì vào lúc 02:00 AM ngày 30/07/2024. Vui lòng lưu lại công việc trước thời gian này." data-timestamp="2024-07-28 10:00:00">
                                <div class="item-icon"><i class="fa-solid fa-wrench"></i></div>
                                <div class="item-content">
                                    <div class="item-title">Cập nhật hệ thống 30/07</div>
                                    <div class="item-time">28 Jul 2024</div>
                                </div>
                            </li>
                            <li class="notification-item" data-title="Thông báo: Khuyến mãi mới" data-body="Chương trình khuyến mãi hè 2024 đã bắt đầu! Giảm giá 10% cho các tuyến đi Mỹ." data-timestamp="2024-07-20 09:00:00">
                                <div class="item-icon"><i class="fa-solid fa-tags"></i></div>
                                <div class="item-content">
                                    <div class="item-title">Khuyến mãi hè 2024!</div>
                                    <div class="item-time">20 Jul 2024</div>
                                </div>
                            </li>
                        </ul>
                        <div class="dropdown-footer"><a href="#">Xem tất cả</a></div>
                    </div>
                </div>
                <div class="user-container" style="position: relative;">
                    <div class="user-dropdown-toggle" id="user-dropdown-toggle" style="display: flex; align-items: center; gap: 6px; background: #6366f1; border-radius: 7px; padding: 6px 14px; cursor: pointer;">
                        <i class="fa-regular fa-circle-user user-icon" id="user-icon" style="color: #fff; font-size: 1.25em;"></i>
                </div>
                    <div class="user-dropdown" id="user-dropdown">
                        <a href="#" class="user-dropdown-item" id="profile-link"><i class="fa-regular fa-user"></i> Profile</a>
                        <a href="#" class="user-dropdown-item" id="login-link"><i class="fa-solid fa-right-to-bracket"></i> Đăng nhập</a>
                        <a href="#" class="user-dropdown-item" id="logout-link"><i class="fa-solid fa-right-from-bracket"></i> Đăng xuất</a>
            </div>
                </div>
            </div>
        </header>

        <div class="content-wrapper">
            <section class="page-header">
                <div class="page-header-left">
                    <h1 class="page-title">DANH SÁCH KHÁCH HÀNG</h1>
                    <nav class="breadcrumb" aria-label="breadcrumb">
                        <a href="#">Quản lý</a> / <span>Quản lý khách hàng</span>
                    </nav>
                </div>
            </section>

            <div class="customer-actions">
                <div class="action-buttons">
                    <button class="btn-add-customer" id="addCustomerBtn">
                        <i class="fa-solid fa-user-plus"></i>
                        Thêm khách hàng
                    </button>
                    <button class="btn-export">
                        <i class="fa-solid fa-file-export"></i>
                        Xuất Excel
                    </button>
                    <button class="btn-import">
                        <i class="fa-solid fa-file-import"></i>
                        Nhập Excel
                    </button>
                </div>
                <div class="filter-section">
                    <div class="filter-group">
                        <select class="filter-select" id="customerType">
                            <option value="">Loại khách hàng</option>
                            <option value="personal">Cá nhân</option>
                            <option value="business">Doanh nghiệp</option>
                        </select>
                        <select class="filter-select" id="customerStatus">
                            <option value="">Trạng thái</option>
                            <option value="active">Đang hoạt động</option>
                            <option value="inactive">Ngừng hoạt động</option>
                        </select>
                    </div>
                </div>
            </div>

            <section class="table-area card">
                <div class="card-header">
                    <h2>Danh sách Khách hàng</h2>
                </div>
                <div class="table-container">
                    <div class="table-wrapper">
                        <table id="customerTable">
                            <thead>
                                <tr>
                                    <th scope="col" class="col-center">
                                        <input type="checkbox" id="select-all-checkbox" title="Chọn tất cả">
                                    </th>
                                    <th scope="col" class="col-center">STT</th>
                                    <th scope="col">Mã KH</th>
                                    <th scope="col">Họ và tên</th>
                                    <th scope="col">Số điện thoại</th>
                                    <th scope="col">Email</th>
                                    <th scope="col">Loại KH</th>
                                    <th scope="col">Địa chỉ</th>
                                    <th scope="col" class="col-center">Trạng thái</th>
                                    <th scope="col" class="col-center">Thao tác</th>
                                </tr>
                            </thead>
                            <tbody id="customer-table-body">
                                <!-- Sample customer data -->
                                <tr>
                                    <td class="col-center"><input type="checkbox" title="Chọn dòng 1"></td>
                                    <td class="col-center">1</td>
                                    <td>KH001</td>
                                    <td>Nguyễn Văn A</td>
                                    <td>0901234567</td>
                                    <td>nguyenvana@email.com</td>
                                    <td>Cá nhân</td>
                                    <td>123 Nguyễn Văn Linh, Q.7, TP.HCM</td>
                                    <td class="col-center"><span class="status-badge active">Hoạt động</span></td>
                                    <td class="col-center action-icons">
                                        <button class="icon-button icon-view" title="Xem chi tiết">
                                            <i class="fa-solid fa-eye"></i>
                                        </button>
                                        <button class="icon-button icon-edit" title="Sửa">
                                            <i class="fa-solid fa-pencil"></i>
                                        </button>
                                        <button class="icon-button icon-danger" title="Xóa">
                                            <i class="fa-solid fa-trash-can"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-center"><input type="checkbox" title="Chọn dòng 2"></td>
                                    <td class="col-center">2</td>
                                    <td>KH002</td>
                                    <td>Công ty TNHH ABC</td>
                                    <td>0909876543</td>
                                    <td>contact@abc.com</td>
                                    <td>Doanh nghiệp</td>
                                    <td>456 Điện Biên Phủ, Q.3, TP.HCM</td>
                                    <td class="col-center"><span class="status-badge active">Hoạt động</span></td>
                                    <td class="col-center action-icons">
                                        <button class="icon-button icon-view" title="Xem chi tiết">
                                            <i class="fa-solid fa-eye"></i>
                                        </button>
                                        <button class="icon-button icon-edit" title="Sửa">
                                            <i class="fa-solid fa-pencil"></i>
                                        </button>
                                        <button class="icon-button icon-danger" title="Xóa">
                                            <i class="fa-solid fa-trash-can"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-center"><input type="checkbox" title="Chọn dòng 3"></td>
                                    <td class="col-center">3</td>
                                    <td>KH003</td>
                                    <td>Trần Thị B</td>
                                    <td>0912345678</td>
                                    <td>tranthib@email.com</td>
                                    <td>Cá nhân</td>
                                    <td>789 Cách Mạng Tháng 8, Q.10, TP.HCM</td>
                                    <td class="col-center"><span class="status-badge inactive">Ngừng hoạt động</span></td>
                                    <td class="col-center action-icons">
                                        <button class="icon-button icon-view" title="Xem chi tiết">
                                            <i class="fa-solid fa-eye"></i>
                                        </button>
                                        <button class="icon-button icon-edit" title="Sửa">
                                            <i class="fa-solid fa-pencil"></i>
                                        </button>
                                        <button class="icon-button icon-danger" title="Xóa">
                                            <i class="fa-solid fa-trash-can"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-center"><input type="checkbox" title="Chọn dòng 4"></td>
                                    <td class="col-center">4</td>
                                    <td>KH004</td>
                                    <td>Công ty CP XYZ</td>
                                    <td>0898765432</td>
                                    <td>info@xyz.com.vn</td>
                                    <td>Doanh nghiệp</td>
                                    <td>147 Võ Văn Ngân, Q.Thủ Đức, TP.HCM</td>
                                    <td class="col-center"><span class="status-badge active">Hoạt động</span></td>
                                    <td class="col-center action-icons">
                                        <button class="icon-button icon-view" title="Xem chi tiết">
                                            <i class="fa-solid fa-eye"></i>
                                        </button>
                                        <button class="icon-button icon-edit" title="Sửa">
                                            <i class="fa-solid fa-pencil"></i>
                                        </button>
                                        <button class="icon-button icon-danger" title="Xóa">
                                            <i class="fa-solid fa-trash-can"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-center"><input type="checkbox" title="Chọn dòng 5"></td>
                                    <td class="col-center">5</td>
                                    <td>KH005</td>
                                    <td>Lê Văn C</td>
                                    <td>0977123456</td>
                                    <td>levanc@email.com</td>
                                    <td>Cá nhân</td>
                                    <td>258 Lý Thường Kiệt, Q.Tân Bình, TP.HCM</td>
                                    <td class="col-center"><span class="status-badge active">Hoạt động</span></td>
                                    <td class="col-center action-icons">
                                        <button class="icon-button icon-view" title="Xem chi tiết">
                                            <i class="fa-solid fa-eye"></i>
                                        </button>
                                        <button class="icon-button icon-edit" title="Sửa">
                                            <i class="fa-solid fa-pencil"></i>
                                        </button>
                                        <button class="icon-button icon-danger" title="Xóa">
                                            <i class="fa-solid fa-trash-can"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-center"><input type="checkbox" title="Chọn dòng 6"></td>
                                    <td class="col-center">6</td>
                                    <td>KH006</td>
                                    <td>Phạm Thị D</td>
                                    <td>0933987654</td>
                                    <td>phamthid@email.com</td>
                                    <td>Cá nhân</td>
                                    <td>369 Huỳnh Tấn Phát, Q.7, TP.HCM</td>
                                    <td class="col-center"><span class="status-badge inactive">Ngừng hoạt động</span></td>
                                    <td class="col-center action-icons">
                                        <button class="icon-button icon-view" title="Xem chi tiết">
                                            <i class="fa-solid fa-eye"></i>
                                        </button>
                                        <button class="icon-button icon-edit" title="Sửa">
                                            <i class="fa-solid fa-pencil"></i>
                                        </button>
                                        <button class="icon-button icon-danger" title="Xóa">
                                            <i class="fa-solid fa-trash-can"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-center"><input type="checkbox" title="Chọn dòng 7"></td>
                                    <td class="col-center">7</td>
                                    <td>KH007</td>
                                    <td>Công ty TNHH DEF</td>
                                    <td>0944556677</td>
                                    <td>contact@def.com.vn</td>
                                    <td>Doanh nghiệp</td>
                                    <td>741 Nguyễn Văn Cừ, Q.5, TP.HCM</td>
                                    <td class="col-center"><span class="status-badge active">Hoạt động</span></td>
                                    <td class="col-center action-icons">
                                        <button class="icon-button icon-view" title="Xem chi tiết">
                                            <i class="fa-solid fa-eye"></i>
                                        </button>
                                        <button class="icon-button icon-edit" title="Sửa">
                                            <i class="fa-solid fa-pencil"></i>
                                        </button>
                                        <button class="icon-button icon-danger" title="Xóa">
                                            <i class="fa-solid fa-trash-can"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-center"><input type="checkbox" title="Chọn dòng 8"></td>
                                    <td class="col-center">8</td>
                                    <td>KH008</td>
                                    <td>Hoàng Văn E</td>
                                    <td>0966778899</td>
                                    <td>hoangvane@email.com</td>
                                    <td>Cá nhân</td>
                                    <td>852 Kha Vạn Cân, Q.Thủ Đức, TP.HCM</td>
                                    <td class="col-center"><span class="status-badge active">Hoạt động</span></td>
                                    <td class="col-center action-icons">
                                        <button class="icon-button icon-view" title="Xem chi tiết">
                                            <i class="fa-solid fa-eye"></i>
                                        </button>
                                        <button class="icon-button icon-edit" title="Sửa">
                                            <i class="fa-solid fa-pencil"></i>
                                        </button>
                                        <button class="icon-button icon-danger" title="Xóa">
                                            <i class="fa-solid fa-trash-can"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-center"><input type="checkbox" title="Chọn dòng 9"></td>
                                    <td class="col-center">9</td>
                                    <td>KH009</td>
                                    <td>Công ty CP GHI</td>
                                    <td>0988990011</td>
                                    <td>info@ghi.com</td>
                                    <td>Doanh nghiệp</td>
                                    <td>963 Lê Văn Việt, Q.9, TP.HCM</td>
                                    <td class="col-center"><span class="status-badge inactive">Ngừng hoạt động</span></td>
                                    <td class="col-center action-icons">
                                        <button class="icon-button icon-view" title="Xem chi tiết">
                                            <i class="fa-solid fa-eye"></i>
                                        </button>
                                        <button class="icon-button icon-edit" title="Sửa">
                                            <i class="fa-solid fa-pencil"></i>
                                        </button>
                                        <button class="icon-button icon-danger" title="Xóa">
                                            <i class="fa-solid fa-trash-can"></i>
                                        </button>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-center"><input type="checkbox" title="Chọn dòng 10"></td>
                                    <td class="col-center">10</td>
                                    <td>KH010</td>
                                    <td>Vũ Thị F</td>
                                    <td>0911223344</td>
                                    <td>vuthif@email.com</td>
                                    <td>Cá nhân</td>
                                    <td>159 Xa lộ Hà Nội, Q.Thủ Đức, TP.HCM</td>
                                    <td class="col-center"><span class="status-badge active">Hoạt động</span></td>
                                    <td class="col-center action-icons">
                                        <button class="icon-button icon-view" title="Xem chi tiết">
                                            <i class="fa-solid fa-eye"></i>
                                        </button>
                                        <button class="icon-button icon-edit" title="Sửa">
                                            <i class="fa-solid fa-pencil"></i>
                                        </button>
                                        <button class="icon-button icon-danger" title="Xóa">
                                            <i class="fa-solid fa-trash-can"></i>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="card-footer">
                    <nav class="pagination" aria-label="Table navigation">
                        <span class="pagination-info">Hiển thị <b>1</b> đến <b>10</b> của <b>100</b> khách hàng</span>
                        <div class="pagination-buttons">
                            <button class="button" disabled>Trước</button>
                            <button class="button active" aria-current="page">1</button>
                            <button class="button">2</button>
                            <button class="button">3</button>
                            <button class="button">...</button>
                            <button class="button">10</button>
                            <button class="button">Sau</button>
                        </div>
                    </nav>
                </div>
            </section>

            <!-- Customer Detail Modal -->
            <div class="modal" id="customerDetailModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Thông tin chi tiết khách hàng</h3>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <div class="customer-info-grid">
                            <div class="info-group">
                                <label>Mã khách hàng:</label>
                                <span id="detailCustomerId">KH001</span>
                            </div>
                            <div class="info-group">
                                <label>Họ và tên:</label>
                                <span id="detailCustomerName">Nguyễn Văn A</span>
                            </div>
                            <div class="info-group">
                                <label>Số điện thoại:</label>
                                <span id="detailCustomerPhone">0901234567</span>
                            </div>
                            <div class="info-group">
                                <label>Email:</label>
                                <span id="detailCustomerEmail">nguyenvana@email.com</span>
                            </div>
                            <div class="info-group">
                                <label>Loại khách hàng:</label>
                                <span id="detailCustomerType">Cá nhân</span>
                            </div>
                            <div class="info-group">
                                <label>Địa chỉ:</label>
                                <span id="detailCustomerAddress">123 Nguyễn Văn Linh, Q.7, TP.HCM</span>
                            </div>
                            <div class="info-group">
                                <label>Ngày tạo:</label>
                                <span id="detailCustomerCreated">01/01/2024</span>
                            </div>
                            <div class="info-group">
                                <label>Trạng thái:</label>
                                <span id="detailCustomerStatus" class="status-badge active">Hoạt động</span>
                            </div>
                        </div>
                        <div class="customer-stats">
                            <h4>Thống kê đơn hàng</h4>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-value">150</div>
                                    <div class="stat-label">Tổng đơn hàng</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value">145</div>
                                    <div class="stat-label">Đơn thành công</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value">5</div>
                                    <div class="stat-label">Đơn hủy</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value">98%</div>
                                    <div class="stat-label">Tỷ lệ thành công</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn-secondary" data-dismiss="modal">Đóng</button>
                        <button class="btn-primary">Chỉnh sửa</button>
                    </div>
                </div>
            </div>

            <!-- Add Customer Modal -->
            <div class="modal" id="addCustomerModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Thêm khách hàng mới</h3>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="addCustomerForm">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="addCustomerId">Mã khách hàng:</label>
                                    <input type="text" id="addCustomerId" required>
                                </div>
                                <div class="form-group">
                                    <label for="addCustomerName">Họ và tên:</label>
                                    <input type="text" id="addCustomerName" required>
                                </div>
                                <div class="form-group">
                                    <label for="addCustomerPhone">Số điện thoại:</label>
                                    <input type="tel" id="addCustomerPhone" required>
                                </div>
                                <div class="form-group">
                                    <label for="addCustomerEmail">Email:</label>
                                    <input type="email" id="addCustomerEmail" required>
                                </div>
                                <div class="form-group">
                                    <label for="addCustomerType">Loại khách hàng:</label>
                                    <select id="addCustomerType" required>
                                        <option value="Cá nhân">Cá nhân</option>
                                        <option value="Doanh nghiệp">Doanh nghiệp</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="addCustomerAddress">Địa chỉ:</label>
                                    <input type="text" id="addCustomerAddress" required>
                                </div>
                                <div class="form-group">
                                    <label for="addCustomerStatus">Trạng thái:</label>
                                    <select id="addCustomerStatus" required>
                                        <option value="active">Hoạt động</option>
                                        <option value="inactive">Ngừng hoạt động</option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button class="btn-secondary" data-dismiss="modal">Hủy</button>
                        <button class="btn-primary" form="addCustomerForm">Thêm</button>
                    </div>
                </div>
            </div>

            <!-- Edit Customer Modal -->
            <div class="modal" id="editCustomerModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Chỉnh sửa thông tin khách hàng</h3>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <form id="editCustomerForm">
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="editCustomerId">Mã khách hàng:</label>
                                    <input type="text" id="editCustomerId" readonly>
                                </div>
                                <div class="form-group">
                                    <label for="editCustomerName">Họ và tên:</label>
                                    <input type="text" id="editCustomerName" required>
                                </div>
                                <div class="form-group">
                                    <label for="editCustomerPhone">Số điện thoại:</label>
                                    <input type="tel" id="editCustomerPhone" required>
                                </div>
                                <div class="form-group">
                                    <label for="editCustomerEmail">Email:</label>
                                    <input type="email" id="editCustomerEmail" required>
                                </div>
                                <div class="form-group">
                                    <label for="editCustomerType">Loại khách hàng:</label>
                                    <select id="editCustomerType" required>
                                        <option value="Cá nhân">Cá nhân</option>
                                        <option value="Doanh nghiệp">Doanh nghiệp</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="editCustomerAddress">Địa chỉ:</label>
                                    <input type="text" id="editCustomerAddress" required>
                                </div>
                                <div class="form-group">
                                    <label for="editCustomerStatus">Trạng thái:</label>
                                    <select id="editCustomerStatus" required>
                                        <option value="active">Hoạt động</option>
                                        <option value="inactive">Ngừng hoạt động</option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button class="btn-secondary" data-dismiss="modal">Hủy</button>
                        <button class="btn-primary" form="editCustomerForm">Lưu</button>
                    </div>
                </div>
            </div>

            <!-- Delete Confirmation Modal -->
            <div class="modal" id="deleteCustomerModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Xác nhận xóa</h3>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <p>Bạn có chắc chắn muốn xóa khách hàng <strong id="deleteCustomerName"></strong>?</p>
                        <p>Hành động này không thể hoàn tác.</p>
                    </div>
                    <div class="modal-footer">
                        <button class="btn-secondary" data-dismiss="modal">Hủy</button>
                        <button class="btn-danger" id="confirmDelete">Xóa</button>
                    </div>
                </div>
            </div>

            <!-- Bulk Delete Confirmation Modal -->
            <div class="modal" id="bulkDeleteModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Xác nhận xóa nhiều</h3>
                        <button class="modal-close">&times;</button>
                    </div>
                    <div class="modal-body">
                        <p>Bạn có chắc chắn muốn xóa <strong id="deleteCount"></strong> khách hàng đã chọn?</p>
                        <p>Hành động này không thể hoàn tác.</p>
                    </div>
                    <div class="modal-footer">
                        <button class="btn-secondary" data-dismiss="modal">Hủy</button>
                        <button class="btn-danger" id="confirmBulkDelete">Xóa</button>
                    </div>
                </div>
            </div>

            <!-- Announcement Modal -->
            <div class="announcement-overlay" id="announcement-overlay" style="display: none;">
                <div class="announcement-box" id="announcement-box">
                    <div class="announcement-header">
                        <span id="announcement-title">Thông báo</span>
                        <button class="announcement-close-btn" id="announcement-close-btn" aria-label="Đóng">&times;</button>
                    </div>
                    <div class="announcement-body" id="announcement-body"></div>
                    <div class="announcement-footer">
                        <span id="announcement-timestamp" style="font-size:0.95em;color:#64748b;"></span>
                    </div>
                </div>
            </div>

            <footer class="site-footer">
                Miền Tây Express © <span id="current-year">2024</span>. All rights reserved. Design by Nina Co.,Ltd
            </footer>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Sidebar & Submenu ---
            const body = document.body;
            const sidebar = document.getElementById('sidebar');
            const sidebarOverlay = document.getElementById('sidebar-overlay');
            const mobileSidebarToggleBtn = document.getElementById('mobile-sidebar-toggle');
            const desktopSidebarToggleBtn = document.querySelector('.sidebar-toggle-desktop');
            function manageBodyScroll() {
                const isSidebarOpen = body.classList.contains('sidebar-mobile-open');
                const isAnyModalVisible = document.querySelector('.confirmation-modal.visible, .filter-modal.visible, .announcement-overlay.visible');
                if (isSidebarOpen || isAnyModalVisible) {
                    body.classList.add('overflow-hidden');
                } else {
                    body.classList.remove('overflow-hidden');
                }
            }
            function toggleSidebarMobile() {
                body.classList.toggle('sidebar-mobile-open');
                manageBodyScroll();
            }
            function toggleSidebarDesktop() {
                body.classList.toggle('sidebar-collapsed');
                manageBodyScroll();
            }
            function toggleSidebarMobileOrDesktop() {
                if (window.innerWidth > 768) {
                    toggleSidebarDesktop();
                } else {
                    toggleSidebarMobile();
                }
                const isOpen = body.classList.contains('sidebar-mobile-open') || !body.classList.contains('sidebar-collapsed');
                if (mobileSidebarToggleBtn) mobileSidebarToggleBtn.setAttribute('aria-expanded', String(isOpen));
            }
            function toggleSubmenu(event) {
                event.preventDefault();
                if (body.classList.contains('sidebar-collapsed') && window.innerWidth > 768) return;
                const parentLink = event.currentTarget;
                const submenuWrapper = parentLink.nextElementSibling;
                if (!submenuWrapper || !submenuWrapper.classList.contains('submenu')) return;
                if (!parentLink.classList.contains('active')) {
                    document.querySelectorAll('.menu-items .submenu-parent.active').forEach(activeParent => {
                        if (activeParent !== parentLink) {
                            activeParent.classList.remove('active');
                            activeParent.nextElementSibling?.classList.remove('active');
                        }
                    });
                }
                submenuWrapper.classList.toggle('active');
                parentLink.classList.toggle('active');
            }
            function initializeActiveSubmenu() {
                const activeSubmenuLink = document.querySelector('.sidebar .submenu a.active');
                if (activeSubmenuLink) {
                    const submenuDiv = activeSubmenuLink.closest('.submenu');
                    const parentLink = submenuDiv?.previousElementSibling;
                    if(submenuDiv && parentLink && parentLink.classList.contains('submenu-parent')) {
                        submenuDiv.classList.add('active');
                        parentLink.classList.add('active');
                    }
                }
            }
            initializeActiveSubmenu();
            if (mobileSidebarToggleBtn) mobileSidebarToggleBtn.addEventListener('click', toggleSidebarMobileOrDesktop);
            if (sidebarOverlay) sidebarOverlay.addEventListener('click', toggleSidebarMobile);
            if (desktopSidebarToggleBtn) desktopSidebarToggleBtn.addEventListener('click', toggleSidebarDesktop);
            document.querySelectorAll('.menu-items .submenu-parent').forEach(link => link.addEventListener('click', toggleSubmenu));

            // --- Notification & Announcement Modal ---
            const notificationButton = document.getElementById('notification-button');
            const notificationDropdown = document.getElementById('notification-dropdown');
            const notificationList = document.getElementById('notification-list');
            const announcementOverlay = document.getElementById('announcement-overlay');
            const announcementBox = document.getElementById('announcement-box');
            const announcementCloseBtn = document.getElementById('announcement-close-btn');
            const announcementTitle = document.getElementById('announcement-title');
            const announcementBody = document.getElementById('announcement-body');
            const announcementTimestamp = document.getElementById('announcement-timestamp');
            function showAnnouncement() {
                if (announcementOverlay) {
                    announcementOverlay.classList.add('visible');
                    announcementOverlay.style.display = 'flex';
                    updateHeaderBlur();
                    if (typeof manageBodyScroll === 'function') manageBodyScroll();
                }
            }
            function closeAnnouncement() {
                if (announcementOverlay) {
                    announcementOverlay.classList.remove('visible');
                    setTimeout(() => { announcementOverlay.style.display = 'none'; updateHeaderBlur(); }, 200);
                    updateHeaderBlur();
                    if (typeof manageBodyScroll === 'function') manageBodyScroll();
                }
            }
            function toggleNotificationDropdown() {
                if (notificationDropdown) {
                    notificationDropdown.classList.toggle('visible');
                }
            }
            function closeNotificationDropdown() {
                if (notificationDropdown) {
                    notificationDropdown.classList.remove('visible');
                }
            }
            if (notificationButton) {
                notificationButton.addEventListener('click', (event) => {
                    event.stopPropagation();
                    toggleNotificationDropdown();
                });
            }
            if (notificationList) {
                notificationList.addEventListener('click', (event) => {
                    const clickedItem = event.target.closest('.notification-item');
                    if (clickedItem && announcementTitle && announcementBody && announcementTimestamp) {
                        const title = clickedItem.dataset.title || 'Thông báo';
                        const bodyText = clickedItem.dataset.body || 'Không có nội dung.';
                        const timestamp = clickedItem.dataset.timestamp || '';
                        announcementTitle.textContent = title;
                        announcementBody.innerHTML = '';
                        bodyText.split('||').forEach(paragraphText => {
                            if(paragraphText.trim()) {
                                const p = document.createElement('p');
                                p.textContent = paragraphText.trim();
                                announcementBody.appendChild(p);
                            }
                        });
                        announcementTimestamp.textContent = timestamp;
                        showAnnouncement();
                        closeNotificationDropdown();
                    }
                });
            }
            document.addEventListener('click', (event) => {
                if (notificationDropdown && notificationDropdown.classList.contains('visible')) {
                    if (!notificationDropdown.contains(event.target) && event.target !== notificationButton && !notificationButton.contains(event.target)) {
                        closeNotificationDropdown();
                    }
                }
            });
            if (announcementCloseBtn) announcementCloseBtn.addEventListener('click', closeAnnouncement);
            if (announcementOverlay) announcementOverlay.addEventListener('click', (event) => { if (event.target === announcementOverlay) closeAnnouncement(); });

            // --- Dropdown user & đăng nhập/đăng xuất ---
            function renderUserDropdown() {
                const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
                const userToggle = document.getElementById('user-dropdown-toggle');
                const userDropdown = document.getElementById('user-dropdown');
                if (!userToggle || !userDropdown) return;
                if (!isLoggedIn) {
                    userToggle.innerHTML = `
                        <div style="background: linear-gradient(135deg, #ffe066 0%, #a78bfa 100%); border-radius: 50%; width: 44px; height: 44px; display: flex; align-items: center; justify-content: center;">
                            <i class="fa-regular fa-circle-user user-icon" style="color: #4F46E5; font-size: 1.5em;"></i>
                        </div>
                    `;
                    userDropdown.innerHTML = `
                        <a href="#" class="user-dropdown-item" id="login-menu-item">
                            <i class="fa-solid fa-right-to-bracket"></i> Đăng nhập
                        </a>
                    `;
                } else {
                    userToggle.innerHTML = `
                        <div style="background: linear-gradient(135deg, #ffe066 0%, #a78bfa 100%); border-radius: 50%; width: 44px; height: 44px; display: flex; align-items: center; justify-content: center;">
                            <i class="fa-regular fa-circle-user user-icon" style="color: #4F46E5; font-size: 1.5em;"></i>
                        </div>
                    `;
                    userDropdown.innerHTML = `
                        <div class="user-info">
                            <div class="user-avatar"><i class="fa-regular fa-circle-user"></i></div>
                            <div class="user-details">
                                <div>Phạm Hoàng Đình</div>
                                <div>Quản trị viên</div>
                            </div>
                        </div>
                        <hr>
                        <a href="#" class="user-dropdown-item"><i class="fa-regular fa-user"></i> Thông tin cá nhân</a>
                        <a href="#" class="user-dropdown-item"><i class="fa-solid fa-gear"></i> Cài đặt tài khoản</a>
                        <a href="#" class="user-dropdown-item"><i class="fa-solid fa-bell"></i> Thông báo</a>
                        <a href="#" class="user-dropdown-item"><i class="fa-solid fa-shield-halved"></i> Bảo mật</a>
                        <hr>
                        <a href="#" class="user-dropdown-item" id="logout-menu-item"><i class="fa-solid fa-right-from-bracket"></i> Đăng xuất</a>
                    `;
                }
                setTimeout(() => {
                    const loginItem = document.getElementById('login-menu-item');
                    if (loginItem) loginItem.onclick = function(e) { e.preventDefault(); window.location.href = 'login.html'; };
                    const logoutItem = document.getElementById('logout-menu-item');
                    if (logoutItem) logoutItem.onclick = function(e) { e.preventDefault(); localStorage.removeItem('isLoggedIn'); window.location.reload(); };
                }, 100);
            }
            renderUserDropdown();
            window.addEventListener('storage', renderUserDropdown);
            // Dropdown show/hide
            const userToggle = document.getElementById('user-dropdown-toggle');
            const userDropdown = document.getElementById('user-dropdown');
            if(userToggle && userDropdown){
                userToggle.addEventListener('click', function(e){
                    e.stopPropagation();
                    userDropdown.classList.toggle('show');
                });
                document.addEventListener('click', function(e){
                    if(!userDropdown.contains(e.target) && e.target !== userToggle){
                        userDropdown.classList.remove('show');
                    }
                });
            }
        });
        (function(){
            var observer = new MutationObserver(updateHeaderBlur);
            document.querySelectorAll('.modal').forEach(function(modal){
                observer.observe(modal, {attributes:true, attributeFilter:['class','style']});
            });
        })();
    </script>
    <script>
    // ================== DuyKha: Quản lý khách hàng động + Lọc + Modal ==================
    let customers = [
        { id: 'KH001', name: 'Nguyễn Văn A', phone: '0901234567', email: 'nguyenvana@email.com', type: 'Cá nhân', address: '123 Nguyễn Văn Linh, Q.7, TP.HCM', status: 'active' },
        { id: 'KH002', name: 'Công ty TNHH ABC', phone: '0909876543', email: 'contact@abc.com', type: 'Doanh nghiệp', address: '456 Điện Biên Phủ, Q.3, TP.HCM', status: 'active' },
        { id: 'KH003', name: 'Trần Thị B', phone: '0912345678', email: 'tranthib@email.com', type: 'Cá nhân', address: '789 Cách Mạng Tháng 8, Q.10, TP.HCM', status: 'inactive' },
        { id: 'KH004', name: 'Công ty CP XYZ', phone: '0898765432', email: 'info@xyz.com.vn', type: 'Doanh nghiệp', address: '147 Võ Văn Ngân, Q.Thủ Đức, TP.HCM', status: 'active' },
        { id: 'KH005', name: 'Lê Văn C', phone: '0977123456', email: 'levanc@email.com', type: 'Cá nhân', address: '258 Lý Thường Kiệt, Q.Tân Bình, TP.HCM', status: 'active' },
        { id: 'KH006', name: 'Phạm Thị D', phone: '0933987654', email: 'phamthid@email.com', type: 'Cá nhân', address: '369 Huỳnh Tấn Phát, Q.7, TP.HCM', status: 'inactive' },
        { id: 'KH007', name: 'Công ty TNHH DEF', phone: '0944556677', email: 'contact@def.com.vn', type: 'Doanh nghiệp', address: '741 Nguyễn Văn Cừ, Q.5, TP.HCM', status: 'active' },
        { id: 'KH008', name: 'Hoàng Văn E', phone: '0966778899', email: 'hoangvane@email.com', type: 'Cá nhân', address: '852 Kha Vạn Cân, Q.Thủ Đức, TP.HCM', status: 'active' },
        { id: 'KH009', name: 'Công ty CP GHI', phone: '0988990011', email: 'info@ghi.com', type: 'Doanh nghiệp', address: '963 Lê Văn Việt, Q.9, TP.HCM', status: 'inactive' },
        { id: 'KH010', name: 'Vũ Thị F', phone: '0911223344', email: 'vuthif@email.com', type: 'Cá nhân', address: '159 Xa lộ Hà Nội, Q.Thủ Đức, TP.HCM', status: 'active' }
    ];
    let filterType = '';
    let filterStatus = '';

    function renderCustomerTable() {
        const tbody = document.getElementById('customer-table-body');
        tbody.innerHTML = '';
        // Lọc dữ liệu
        let filtered = customers.filter(c => {
            let ok = true;
            if (filterType) ok = ok && (c.type === (filterType === 'personal' ? 'Cá nhân' : 'Doanh nghiệp'));
            if (filterStatus) ok = ok && (c.status === filterStatus);
            return ok;
        });
        filtered.forEach((c, idx) => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td class="col-center"><input type="checkbox" title="Chọn dòng ${idx+1}"></td>
                <td class="col-center">${idx+1}</td>
                <td>${c.id}</td>
                <td>${c.name}</td>
                <td>${c.phone}</td>
                <td>${c.email}</td>
                <td>${c.type}</td>
                <td>${c.address}</td>
                <td class="col-center"><span class="status-badge ${c.status==='active'?'active':'inactive'}">${c.status==='active'?'Hoạt động':'Ngừng hoạt động'}</span></td>
                <td class="col-center action-icons">
                    <button class="icon-button icon-view" title="Xem chi tiết"><i class="fa-solid fa-eye"></i></button>
                    <button class="icon-button icon-edit" title="Sửa"><i class="fa-solid fa-pencil"></i></button>
                    <button class="icon-button icon-danger" title="Xóa"><i class="fa-solid fa-trash-can"></i></button>
                </td>
            `;
            // Gắn lại sự kiện cho các nút
            tr.querySelector('.icon-view').onclick = () => openDetailModalById(c.id);
            tr.querySelector('.icon-edit').onclick = () => openEditModalById(c.id);
            tr.querySelector('.icon-danger').onclick = () => openDeleteModalById(c.id);
            tbody.appendChild(tr);
        });
    }

    // Lọc
    const customerTypeSelect = document.getElementById('customerType');
    const customerStatusSelect = document.getElementById('customerStatus');
    if (customerTypeSelect) customerTypeSelect.onchange = function() {
        filterType = this.value;
        renderCustomerTable();
    };
    if (customerStatusSelect) customerStatusSelect.onchange = function() {
        filterStatus = this.value;
        renderCustomerTable();
    };

    // Thêm khách hàng
    function getNextCustomerId() {
        let max = 0;
        customers.forEach(c => {
            const num = parseInt(c.id.replace('KH',''));
            if(num > max) max = num;
        });
        return 'KH' + String(max+1).padStart(3,'0');
    }
    function openAddModal() {
        var modal = document.getElementById('addCustomerModal');
        if(modal) modal.classList.add('show');
        document.getElementById('addCustomerId').value = getNextCustomerId();
        document.getElementById('addCustomerId').readOnly = true;
        document.getElementById('addCustomerName').value = '';
        document.getElementById('addCustomerPhone').value = '';
        document.getElementById('addCustomerEmail').value = '';
        document.getElementById('addCustomerType').value = 'Cá nhân';
        document.getElementById('addCustomerAddress').value = '';
        document.getElementById('addCustomerStatus').value = 'active';
    }
    document.getElementById('addCustomerBtn').onclick = openAddModal;
    document.getElementById('addCustomerForm').onsubmit = function(e){
        e.preventDefault();
        const newCus = {
            id: document.getElementById('addCustomerId').value,
            name: document.getElementById('addCustomerName').value,
            phone: document.getElementById('addCustomerPhone').value,
            email: document.getElementById('addCustomerEmail').value,
            type: document.getElementById('addCustomerType').value,
            address: document.getElementById('addCustomerAddress').value,
            status: document.getElementById('addCustomerStatus').value
        };
        customers.push(newCus);
        renderCustomerTable();
        document.getElementById('addCustomerModal').classList.remove('show');
    };
    Array.from(document.querySelectorAll('#addCustomerModal .modal-close, #addCustomerModal [data-dismiss="modal"]')).forEach(btn=>{
        btn.onclick = ()=>{ document.getElementById('addCustomerModal').classList.remove('show'); };
    });

    // Sửa khách hàng
    let editingId = null;
    function openEditModalById(id) {
        editingId = id;
        const c = customers.find(cus => cus.id === id);
        var modal = document.getElementById('editCustomerModal');
        if(modal) modal.classList.add('show');
        document.getElementById('editCustomerId').value = c.id;
        document.getElementById('editCustomerName').value = c.name;
        document.getElementById('editCustomerPhone').value = c.phone;
        document.getElementById('editCustomerEmail').value = c.email;
        document.getElementById('editCustomerType').value = c.type;
        document.getElementById('editCustomerAddress').value = c.address;
        document.getElementById('editCustomerStatus').value = c.status;
    }
    document.getElementById('editCustomerForm').onsubmit = function(e){
        e.preventDefault();
        if(editingId!==null) {
            const idx = customers.findIndex(cus => cus.id === editingId);
            customers[idx] = {
                id: document.getElementById('editCustomerId').value,
                name: document.getElementById('editCustomerName').value,
                phone: document.getElementById('editCustomerPhone').value,
                email: document.getElementById('editCustomerEmail').value,
                type: document.getElementById('editCustomerType').value,
                address: document.getElementById('editCustomerAddress').value,
                status: document.getElementById('editCustomerStatus').value
            };
            renderCustomerTable();
            document.getElementById('editCustomerModal').classList.remove('show');
        }
    };
    Array.from(document.querySelectorAll('#editCustomerModal .modal-close, #editCustomerModal [data-dismiss="modal"]')).forEach(btn=>{
        btn.onclick = ()=>{ document.getElementById('editCustomerModal').classList.remove('show'); };
    });

    // Xóa khách hàng
    let deletingId = null;
    function openDeleteModalById(id) {
        deletingId = id;
        const c = customers.find(cus => cus.id === id);
        var modal = document.getElementById('deleteCustomerModal');
        if(modal) modal.classList.add('show');
        document.getElementById('deleteCustomerName').textContent = c.name;
    }
    document.getElementById('confirmDelete').onclick = function(){
        if(deletingId!==null) {
            const idx = customers.findIndex(cus => cus.id === deletingId);
            customers.splice(idx,1);
            renderCustomerTable();
            document.getElementById('deleteCustomerModal').classList.remove('show');
        }
    };
    Array.from(document.querySelectorAll('#deleteCustomerModal .modal-close, #deleteCustomerModal [data-dismiss="modal"]')).forEach(btn=>{
        btn.onclick = ()=>{ document.getElementById('deleteCustomerModal').classList.remove('show'); };
    });

    // Xem chi tiết
    function openDetailModalById(id) {
        const c = customers.find(cus => cus.id === id);
        document.getElementById('detailCustomerId').textContent = c.id;
        document.getElementById('detailCustomerName').textContent = c.name;
        document.getElementById('detailCustomerPhone').textContent = c.phone;
        document.getElementById('detailCustomerEmail').textContent = c.email;
        document.getElementById('detailCustomerType').textContent = c.type;
        document.getElementById('detailCustomerAddress').textContent = c.address;
        document.getElementById('detailCustomerStatus').textContent = c.status==='active'?'Hoạt động':'Ngừng hoạt động';
        document.getElementById('detailCustomerStatus').className = 'status-badge ' + (c.status==='active'?'active':'inactive');
        document.getElementById('customerDetailModal').classList.add('show');
    }
    Array.from(document.querySelectorAll('#customerDetailModal .modal-close, #customerDetailModal [data-dismiss="modal"]')).forEach(btn=>{
        btn.onclick = ()=>{ document.getElementById('customerDetailModal').classList.remove('show'); };
    });

    // Đóng modal bulk delete (nếu có)
    Array.from(document.querySelectorAll('#bulkDeleteModal .modal-close, #bulkDeleteModal [data-dismiss="modal"]')).forEach(btn=>{
        btn.onclick = ()=>{ document.getElementById('bulkDeleteModal').classList.remove('show'); };
    });

    // Render lần đầu
    renderCustomerTable();
    // ================== END DuyKha ==================
    </script>
    <script>
    // ================== DuyKha: Hàm updateHeaderBlur toàn cục ==================
    function updateHeaderBlur() {
        var header = document.querySelector('.header');
        var anyModalOpen = false;
        document.querySelectorAll('.modal').forEach(function(modal){
            var style = window.getComputedStyle(modal);
            if(style.display === 'flex' || style.display === 'block') anyModalOpen = true;
        });
        if(document.querySelector('.announcement-overlay.visible')) anyModalOpen = true;
        if (header) {
            if (anyModalOpen) {
                header.classList.add('blurred');
                if (!header.querySelector('.header-dark-overlay')) {
                    var overlay = document.createElement('div');
                    overlay.className = 'header-dark-overlay';
                    header.appendChild(overlay);
                }
            } else {
                header.classList.remove('blurred');
                var overlay = header.querySelector('.header-dark-overlay');
                if (overlay) overlay.remove();
            }
        }
    }
    // ================== END DuyKha ==================
    </script>
</body>
</html>
